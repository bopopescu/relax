# Reading and processing the data for 1H/15N ZQ coherences.

read ../zq_500.res d 1 Z H1/N15 25 500 0.03 @ c    # 15N/1H ZQ data at 500 MHz
read ../zq_600.res d 1 Z H1/N15 25 600 0.03 @ c    # 15N/1H ZQ data at 600 MHz
read ../zq_800.res d 1 Z H1/N15 25 800 0.03 @ c    # 15N/1H ZQ data at 800 MHz

# seting initial approximations for exchange parameters
# performing two seperate optimizations (1) with delta_cs(N)>0, delta_cs(H)<0 and 
# (2) with delta_cs(N)<0, delta_cs(H)>0

set m 2 0            # set 2-site exchange model; no simultaneous 15N/1H 180 pulse is applied in MQ sequences
set k @ 0 371.076657461446 u      # set kex(AB) equal to 500 1/s; adjustable (u)
set p @ 0 0.999999 f # set populations 95%/5%
set p @ 1 0.05707800678239605 u     
set c @ N15 0 0 @ f
set c @ N15 1 0 2.30604327221814 u  # set 15N chemical shift in state B equals to 2.0, adjustable
set c @ H1 0 0 @ f
set c @ H1 1 0 0.576576043850393 u # set 1H chemical shift in state B equals to -0.2, adjustable 
set r @ M @ @ @ @ @ u g
min                   # perform minimization
write > d
write > p
