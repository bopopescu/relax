


                                  relax repository checkout r20010
                     svn+ssh://bugman@svn.gna.org/svn/relax/branches/relax_disp

                              Molecular dynamics by NMR data analysis

                             Copyright (C) 2001-2006 Edward d'Auvergne
                         Copyright (C) 2006-2013 the relax development team

This is free software which you are welcome to modify and redistribute under the conditions of the
GNU General Public License (GPL).  This program, including all modules, is licensed under the GPL
and comes with absolutely no warranty.  For details type 'GPL' within the relax prompt.

Assistance in using the relax prompt and scripting interface can be accessed by typing 'help' within
the prompt.

Processor fabric:  Uni-processor.

script = 'relax_disp.py'
----------------------------------------------------------------------------------------------------
"""Script for CPMG relaxation dispersion curve fitting using Dr. Flemming Hansen's data from http://dx.doi.org/10.1021/jp074793o.

To run:

$ ../../../../../relax --tee relax_disp.log relax_disp.py
"""


# Python module imports.
from os import sep

# relax module imports.
from auto_analyses.relax_disp import Relax_disp
from data_store import Relax_data_store; ds = Relax_data_store()
from status import Status; status = Status()


# The dispersion models.
MODELS = ['No Rex', 'LM63', 'CR72', 'IT99']
MODELS = ['IT99']

# The grid search size (the number of increments per dimension).
GRID_INC = 11

# The number of Monte Carlo simulations to be used for error analysis at the end of the analysis.
MC_NUM = 50



# Create the data pipe.
pipe_name = 'base pipe'
pipe_bundle = 'relax_disp'
pipe.create(pipe_name=pipe_name, bundle=pipe_bundle, pipe_type='relax_disp')

# The path to the data files.
data_path = status.install_path + sep+'test_suite'+sep+'shared_data'+sep+'dispersion'+sep+'Hansen'

# Load the saved base pipe
results.read(data_path+sep+'base_pipe')

# Set the nuclear isotope data.
spin.isotope('15N')

# Create the R2eff data pipe and load the results.
pipe.create(pipe_name='R2eff', bundle=pipe_bundle, pipe_type='relax_disp')
pipe.switch(pipe_name='R2eff')
results.read(data_path+sep+'r2eff_pipe')


# Auto-analysis execution.
##########################

# Do not change!
Relax_disp(pipe_name=pipe_name, pipe_bundle=pipe_bundle, models=MODELS, grid_inc=GRID_INC, mc_sim_num=MC_NUM)
----------------------------------------------------------------------------------------------------

relax> pipe.create(pipe_name='base pipe', pipe_type='relax_disp', bundle='relax_disp')

relax> results.read(file='/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/base_pipe', dir=None)
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/base_pipe.bz2' for reading.

relax> spin.isotope(isotope='15N', spin_id=None, force=False)

relax> pipe.create(pipe_name='R2eff', pipe_type='relax_disp', bundle='relax_disp')

relax> pipe.switch(pipe_name='R2eff')

relax> results.read(file='/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_pipe', dir=None)
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/r2eff_pipe.bz2' for reading.




=======================================
= Relaxation dispersion auto-analysis =
=======================================


relax> spectrum.error_analysis(subset=['500_reference.in', '500_66.667.in', '500_133.33.in', '500_133.33.in.bis', '500_200.in', '500_266.67.in', '500_333.33.in', '500_400.in', '500_466.67.in', '500_533.33.in', '500_533.33.in.bis', '500_600.in', '500_666.67.in', '500_733.33.in', '500_800.in', '500_866.67.in', '500_933.33.in', '500_933.33.in.bis', '500_1000.in'])
Intensity measure:  Peak heights.
Replicated spectra:  Yes.
All spectra replicated:  No.

Variance averaging over all spectra.
Standard deviation for all spins:  275.55896394926458

relax> spectrum.error_analysis(subset=['800_reference.in', '800_66.667.in', '800_133.33.in', '800_133.33.in.bis', '800_200.in', '800_266.67.in', '800_333.33.in', '800_400.in', '800_466.67.in', '800_533.33.in', '800_533.33.in.bis', '800_600.in', '800_666.67.in', '800_733.33.in', '800_800.in', '800_866.67.in', '800_933.33.in', '800_933.33.in.bis', '800_1000.in'])
Intensity measure:  Peak heights.
Replicated spectra:  Yes.
All spectra replicated:  No.

Variance averaging over all spectra.
Standard deviation for all spins:  282.10831679853857



--------------------
- The 'IT99' model -
--------------------


relax> pipe.copy(pipe_from='base pipe', pipe_to='IT99', bundle_to='relax_disp')

relax> pipe.switch(pipe_name='IT99')

relax> relax_disp.select_model(model='IT99')
The Ishima and Torchia (1999) CPMG 2-site model for all time scales with pA >> pB.

relax> value.copy(pipe_from='R2eff', pipe_to='IT99', param='r2eff')

relax> grid_search(lower=None, upper=None, inc=11, constraints=True, verbosity=1)


Fitting to the spin block [':70@N']
-----------------------------------

Unconstrained grid search size: 161051 (constraints may decrease this size).


Grid search
~~~~~~~~~~~

Searching through 161051 grid nodes.
k: 0        xk: [            0.1,             0.1,               0,               0,           5e-10]    fk: 72021.7966377       
k: 1        xk: [           0.49,             0.1,               0,               0,           5e-10]    fk: 69106.5233624       
k: 2        xk: [           0.88,             0.1,               0,               0,           5e-10]    fk: 67684.7576037       
k: 11       xk: [            0.1,            0.49,               0,               0,           5e-10]    fk: 43250.8434503       
k: 12       xk: [           0.49,            0.49,               0,               0,           5e-10]    fk: 40335.5701751       
k: 13       xk: [           0.88,            0.49,               0,               0,           5e-10]    fk: 38913.8044163       
k: 22       xk: [            0.1,            0.88,               0,               0,           5e-10]    fk: 22986.2996385       
k: 23       xk: [           0.49,            0.88,               0,               0,           5e-10]    fk: 20071.0263633       
k: 24       xk: [           0.88,            0.88,               0,               0,           5e-10]    fk: 18649.2606045       
k: 33       xk: [            0.1,            1.27,               0,               0,           5e-10]    fk: 11228.1652023       
k: 34       xk: [           0.49,            1.27,               0,               0,           5e-10]    fk: 8312.89192706       
k: 35       xk: [           0.88,            1.27,               0,               0,           5e-10]    fk: 6891.12616832       
k: 45       xk: [           0.49,            1.66,               0,               0,           5e-10]    fk: 5061.16686639       
k: 46       xk: [           0.88,            1.66,               0,               0,           5e-10]    fk: 3639.40110765       
k: 398      xk: [           0.88,            1.27,               3,               0,           5e-10]    fk: 3486.14204507       
k: 16128    xk: [           0.88,            1.27,               1,               1,     5.00045e-06]    fk: 3067.45127992       
k: 17459    xk: [           0.88,            1.27,               1,               2,     5.00045e-06]    fk: 2530.6116043        
k: 17470    xk: [           0.88,            1.66,               1,               2,     5.00045e-06]    fk: 2441.43495294       
k: 18801    xk: [           0.88,            1.66,               1,               3,     5.00045e-06]    fk: 2241.28586804       
k: 18911    xk: [           0.88,            1.27,               2,               3,     5.00045e-06]    fk: 1587.01685933       
k: 20242    xk: [           0.88,            1.27,               2,               4,     5.00045e-06]    fk: 1401.39008639       
k: 21694    xk: [           0.88,            1.27,               3,               5,     5.00045e-06]    fk: 989.32131765        
k: 23025    xk: [           0.88,            1.27,               3,               6,     5.00045e-06]    fk: 840.541070334       
k: 24477    xk: [           0.88,            1.27,               4,               7,     5.00045e-06]    fk: 666.058706069       
k: 25808    xk: [           0.88,            1.27,               4,               8,     5.00045e-06]    fk: 531.348753435       
k: 27139    xk: [           0.88,            1.27,               4,               9,     5.00045e-06]    fk: 529.562088605       
k: 27260    xk: [           0.88,            1.27,               5,               9,     5.00045e-06]    fk: 499.162118584       
k: 28591    xk: [           0.88,            1.27,               5,              10,     5.00045e-06]    fk: 371.061010534       

Optimised parameter values:
r2 (500.000 MHz):            8.800000000000001
r2 (800.000 MHz):           12.699999999999999
phi_ex:                      5.000000000000000
padw2:                      10.000000000000000
tex:                         0.050004500000000


Fitting to the spin block [':71@N']
-----------------------------------

Unconstrained grid search size: 161051 (constraints may decrease this size).


Grid search
~~~~~~~~~~~

Searching through 161051 grid nodes.
k: 0        xk: [            0.1,             0.1,               0,               0,           5e-10]    fk: 3215.70669559       
k: 1        xk: [           0.49,             0.1,               0,               0,           5e-10]    fk: 164.788885002       
k: 122      xk: [           0.49,             0.1,               1,               0,           5e-10]    fk: 71.5989767782       
k: 243      xk: [           0.49,             0.1,               2,               0,           5e-10]    fk: 48.2836648853       
k: 22749    xk: [           0.49,             0.1,               1,               6,     5.00045e-06]    fk: 41.9644785131       
k: 24080    xk: [           0.49,             0.1,               1,               7,     5.00045e-06]    fk: 35.6545060311       
k: 25411    xk: [           0.49,             0.1,               1,               8,     5.00045e-06]    fk: 33.2587583348       
k: 26742    xk: [           0.49,             0.1,               1,               9,     5.00045e-06]    fk: 33.0733056559       
k: 41504    xk: [           0.49,             0.1,               2,               9,     1.00004e-05]    fk: 33.0673833655       
k: 42956    xk: [           0.49,             0.1,               3,              10,     1.00004e-05]    fk: 28.5627125923       
k: 57718    xk: [           0.49,             0.1,               4,              10,    1.500035e-05]    fk: 26.0084474154       

Optimised parameter values:
r2 (500.000 MHz):            4.900000000000000
r2 (800.000 MHz):            1.000000000000000
phi_ex:                      4.000000000000000
padw2:                      10.000000000000000
tex:                         0.150003500000000

relax> minimise(min_algor='simplex', line_search=None, hessian_mod=None, hessian_type=None, func_tol=1e-25, grad_tol=None, max_iter=10000000, constraints=True, scaling=True, verbosity=1)


Fitting to the spin block [':70@N']
-----------------------------------



Logarithmic barrier function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
k: 0        xk: [           0.88,            1.27,               5,              10,     5.00045e-06]    fk: 371.061010534       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [           0.88,            1.27,               5,            10.5,     5.00045e-06]    fk: 346.960399921       
	k: 100      xk: [   0.6872377674,     1.077409727,     4.746697733,     24.60921445,   1.8423829e-06]    fk: 78.1680079605       
	k: 200      xk: [   0.6931779796,     1.074887085,     4.644928037,     25.12097387, 1.776928052e-06]    fk: 77.3905795524       
	k: 300      xk: [   0.6864889305,     1.069172675,    0.4102921504,     25.29049844, 1.444078368e-07]    fk: 60.5089494385       
	k: 400      xk: [   0.7105354392,    0.9920786934,    0.2742171771,     25.19722872, 7.735719856e-08]    fk: 37.0608020799       

	Parameter values: [0.69599004025085209, 0.98033958275151112, 0.26454425713774543, 24.640829686966036, 7.2666619944472037e-08]
	Function value:   35.197550004281872
	Iterations:       500
	Function calls:   794
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 1        xk: [   0.6959900403,    0.9803395828,    0.2645442571,     24.64082969, 7.266661994e-08]    fk: 35.1071578468       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.6959900403,    0.9803395828,    0.2645442571,     24.64082969, 7.266661994e-08]    fk: 35.1080617684       
	k: 100      xk: [   0.7256870485,     1.011151233,    0.2371412798,     22.11531752,  7.10661326e-08]    fk: 31.733570408        
	k: 200      xk: [   0.7253469426,     1.007100325,    0.2356472872,     22.06475512, 6.971464078e-08]    fk: 31.6886461496       
	k: 300      xk: [   0.7253463928,     1.007100529,    0.2356475382,     22.06475316, 6.971479581e-08]    fk: 31.6886461475       

	Parameter values: [0.72534639277303914, 1.0071005293039021, 0.23564753815210615, 22.064753160857986, 6.9714795806554364e-08]
	Function value:   31.688646147531365
	Iterations:       359
	Function calls:   698
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 2        xk: [   0.7253463928,     1.007100529,    0.2356475382,     22.06475316, 6.971479581e-08]    fk: 31.6877220011       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.7253463928,     1.007100529,    0.2356475382,     22.06475316, 6.971479581e-08]    fk: 31.6877312426       
	k: 100      xk: [   0.7253463928,     1.007100529,    0.2356475382,     22.06475316, 6.971479581e-08]    fk: 31.6877312426       
	k: 200      xk: [   0.7253464614,     1.007100441,    0.2356473406,     22.06474193, 6.971471003e-08]    fk: 31.6877312424       

	Parameter values: [0.72534646141864934, 1.0071004414760405, 0.23564734060946427, 22.06474193451891, 6.9714710028985672e-08]
	Function value:   31.687731242443306
	Iterations:       252
	Function calls:   515
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 3        xk: [   0.7253464614,     1.007100441,    0.2356473406,     22.06474193, 6.971471003e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.7253464614,     1.007100441,    0.2356473406,     22.06474193, 6.971471003e-08]    fk: 31.6877220934       
	k: 100      xk: [   0.7253464614,     1.007100441,    0.2356473406,     22.06474193, 6.971471003e-08]    fk: 31.6877220934       
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.6877220934       

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722093391102
	Iterations:       276
	Function calls:   545
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 4        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.6877220019       
	k: 100      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.6877220019       
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.6877220019       

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722001900575
	Iterations:       284
	Function calls:   575
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 5        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 100      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722000985666
	Iterations:       284
	Function calls:   575
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 6        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 100      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722000976521
	Iterations:       284
	Function calls:   575
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 7        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 100      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722000976429
	Iterations:       284
	Function calls:   575
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 8        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 100      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        
	k: 200      xk: [     0.72534646,     1.007100439,    0.2356473403,     22.06474194, 6.971470943e-08]    fk: 31.687722001        

	Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
	Function value:   31.687722000976429
	Iterations:       284
	Function calls:   575
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.


Parameter values: [0.72534645997102232, 1.0071004390824911, 0.23564734031051848, 22.064741940654528, 6.9714709426563333e-08]
Function value:   31.687722000976429
Iterations:       2807
Function calls:   5427
Gradient calls:   0
Hessian calls:    0
Warning:          None


Optimised parameter values:
r2 (500.000 MHz):            7.253464599710223
r2 (800.000 MHz):           10.071004390824911
phi_ex:                      0.235647340310518
padw2:                      22.064741940654528
tex:                         0.000697147094266


Fitting to the spin block [':71@N']
-----------------------------------



Logarithmic barrier function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
k: 0        xk: [           0.49,             0.1,               4,              10,    1.500035e-05]    fk: 26.0084474154       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [         0.5145,             0.1,               4,              10,    1.500035e-05]    fk: 14.8458301901       
	k: 100      xk: [   0.5123469906,    0.0442551344,     2.603804877,     31.40131628, 4.826255497e-06]    fk: 1.85701355387       
	k: 200      xk: [   0.5098478884,   0.04415575599,     2.429700006,     32.42330393, 4.276333764e-06]    fk: 1.83593540685       
	k: 300      xk: [   0.5099663078,   0.04158896355,     2.617845435,     32.25882573, 4.630930315e-06]    fk: 1.83536904298       
	k: 400      xk: [    0.511055075,     15.73771813,     508.1107804,     31.52895167, 0.0009227650958]    fk: 1.69086437569       

	Parameter values: [0.51070494087869456, 9.0069283726870353, 902.72211931482161, 32.118090522522607, 0.0016219640805872938]
	Function value:   1.6772248824523093
	Iterations:       500
	Function calls:   788
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 1        xk: [   0.5107049409,     9.006928373,     902.7221193,     32.11809052,  0.001621964081]    fk: 1.78362290532       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5107049409,     9.457274791,     902.7221193,     32.11809052,  0.001621964081]    fk: 1.78358857995       
	k: 100      xk: [   0.5096673804,     10.14971669,     913.0164106,     32.57625024,  0.001599310569]    fk: 1.77651111514       
	k: 200      xk: [   0.5096678358,      9.14124867,     921.8836022,     32.57723002,  0.001614811656]    fk: 1.77650991738       
	k: 300      xk: [   0.5096647266,     10.05479025,     952.3551141,     32.58536207,  0.001667654519]    fk: 1.77650471894       
	k: 400      xk: [   0.5094922595,     4.763992084,      21883.5896,     32.70193251,   0.03817093519]    fk: 1.77598681374       

	Parameter values: [0.5094746366768288, 11.100060433522984, 67950368.5191807, 32.677350320874709, 118.51929003634034]
	Function value:   1.7743706882198442
	Iterations:       500
	Function calls:   795
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 2        xk: [   0.5094746367,     11.10006043,     67950368.52,     32.67735032,       118.51929]    fk: 1.77770400634       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5094746367,     11.10006043,     67950368.52,     32.67735032,       118.51929]    fk: 1.77765596306       
	k: 100      xk: [   0.5096679706,     11.01080131,      67647158.6,     32.57572105,     118.4979866]    fk: 1.7775542372        
	k: 200      xk: [    0.509667994,     9.732964615,     67875661.17,      32.5757251,     118.8982894]    fk: 1.7775542209        
	k: 300      xk: [   0.5096686334,      9.95852202,     67996179.76,     32.57548216,     119.1107944]    fk: 1.77755421786       
	k: 400      xk: [   0.5096791694,     7.116520227,       193280651,     32.56873999,     338.6566486]    fk: 1.77755250566       

	Parameter values: [0.50967705736945224, 3.2778205997540582, 1304559293837.4905, 32.568284507711127, 2285781.7655676519]
	Function value:   1.7775353459231484
	Iterations:       500
	Function calls:   789
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Maximum number of iterations reached

k: 3        xk: [   0.5096770574,       3.2778206, 1.304559294e+12,     32.56828451,     2285781.766]    fk: 1.77758865264       
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096770574,      3.44171163, 1.304559294e+12,     32.56828451,     2285781.766]    fk: 1.77758714461       
	k: 100      xk: [   0.5096679705,     3.367604204, 1.304926341e+12,     32.57573165,     2285848.046]    fk: 1.77758689286       
	k: 200      xk: [   0.5096678877,     7.431117889, 1.304121594e+12,       32.575677,     2284439.964]    fk: 1.77758688787       
	k: 300      xk: [   0.5096679694,     9.985278618, 1.303616733e+12,     32.57573205,     2283554.075]    fk: 1.77758688708       

	Parameter values: [0.50966796943418524, 9.9852786183446156, 1303616732563.7224, 32.575732045190534, 2283554.0750015341]
	Function value:   1.7775868870803246
	Iterations:       394
	Function calls:   867
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 4        xk: [   0.5096679694,     9.985278618, 1.303616733e+12,     32.57573205,     2283554.075]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.985278618, 1.303616733e+12,     32.57573205,     2283554.075]    fk: 1.77758741101       
	k: 100      xk: [   0.5096679694,     9.985278618, 1.303616733e+12,     32.57573205,     2283554.075]    fk: 1.77758741101       
	k: 200      xk: [   0.5096679694,     9.985584767, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.77758741101       

	Parameter values: [0.50966796941752235, 9.9855847672236902, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.7775874110087722
	Iterations:       215
	Function calls:   521
	Gradient calls:   0
	Hessian calls:    0
	Warning:          None

k: 5        xk: [   0.5096679694,     9.985584767, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.985584767, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.77758741625       
	k: 100      xk: [   0.5096679694,     9.985584767, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.77758741625       

	Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.7775874162480563
	Iterations:       174
	Function calls:   452
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 6        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
	k: 100      xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        

	Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.777587416300449
	Iterations:       174
	Function calls:   452
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 7        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
	k: 100      xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        

	Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.7775874163009728
	Iterations:       174
	Function calls:   452
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 8        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
	k: 100      xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        

	Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.7775874163009784
	Iterations:       174
	Function calls:   452
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.

k: 9        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
Entering sub-algorithm.
	
	Simplex minimisation
	~~~~~~~~~~~~~~~~~~~~

	k: 0        xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        
	k: 100      xk: [   0.5096679694,     9.993386005, 1.303616752e+12,     32.57573205,     2283554.109]    fk: 1.7775874163        

	Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
	Function value:   1.7775874163009784
	Iterations:       174
	Function calls:   452
	Gradient calls:   0
	Hessian calls:    0
	Warning:          Simplex has not moved.


Parameter values: [0.50966796941752235, 9.9933860053230852, 1303616752451.5693, 32.575732052880795, 2283554.1091663344]
Function value:   1.7775874163009784
Iterations:       2979
Function calls:   6020
Gradient calls:   0
Hessian calls:    0
Warning:          None


Optimised parameter values:
r2 (500.000 MHz):            5.096679694175224
r2 (800.000 MHz):           99.933860053230859
phi_ex:              1303616752451.569335937500000
padw2:                      32.575732052880795
tex:                 22835541091.663345336914062

relax> monte_carlo.setup(number=50)

relax> monte_carlo.create_data(method='back_calc')

relax> monte_carlo.initial_values()

relax> minimise(min_algor='simplex', line_search=None, hessian_mod=None, hessian_type=None, func_tol=1e-25, grad_tol=None, max_iter=10000000, constraints=True, scaling=True, verbosity=1)
Simulation 1
Simulation 2
Simulation 3
Simulation 4
Simulation 5
Simulation 6
Simulation 7
Simulation 8
Simulation 9
Simulation 10
Simulation 11
Simulation 12
Simulation 13
Simulation 14
Simulation 15
Simulation 16
Simulation 17
Simulation 18
Simulation 19
Simulation 20
Simulation 21
Simulation 22
Simulation 23
Simulation 24
Simulation 25
Simulation 26
Simulation 27
Simulation 28
Simulation 29
Simulation 30
Simulation 31
Simulation 32
Simulation 33
Simulation 34
Simulation 35
Simulation 36
Simulation 37
Simulation 38
Simulation 39
Simulation 40
Simulation 41
Simulation 42
Simulation 43
Simulation 44
Simulation 45
Simulation 46
Simulation 47
Simulation 48
Simulation 49
Simulation 50

relax> monte_carlo.error_analysis()

relax> results.write(file='results', dir='/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99', compress_type=1, force=True)
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99/results.bz2' for writing.

relax> relax_disp.plot_disp_curves(dir='/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99', force=True)
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99/disp_:70@N.agr' for writing.
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99/disp_:71@N.agr' for writing.

relax> grace.write(x_data_type='res_num', y_data_type='chi2', spin_id=None, plot_data='value', file='chi2.agr', dir='/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99', force=True, norm=False)
Opening the file '/data/edau/relax/branches/relax_disp/test_suite/shared_data/dispersion/Hansen/relax_results/IT99/chi2.agr' for writing.
RelaxWarning: Model selection in the dispersion auto-analysis has been skipped as only 1 models have been optimised.

