


                                     relax repository checkout

                              Molecular dynamics by NMR data analysis

                             Copyright (C) 2001-2006 Edward d'Auvergne
                         Copyright (C) 2006-2011 the relax development team

This is free software which you are welcome to modify and redistribute under the conditions of the
GNU General Public License (GPL).  This program, including all modules, is licensed under the GPL
and comes with absolutely no warranty.  For details type 'GPL' within the relax prompt.

Assistance in using the relax prompt and scripting interface can be accessed by typing 'help' within
the prompt.

Processor fabric:  Uni-processor.

script = 'generate_distribution.py'
----------------------------------------------------------------------------------------------------
# Script for generating the distribution of PDB structures.

# Python module imports.
from numpy import array, cross, dot, float64, zeros
from numpy.linalg import norm

# relax module imports.
from maths_fns.rotation_matrix import axis_angle_to_R


# The number of structures.
INC = 2
N = 60 / INC

# Create a data pipe.
pipe.create('generate', 'N-state')

# The axis for the rotations (the pivot point to CoM axis).
pivot = array([ 37.254, 0.5, 16.7465])
com = array([ 26.83678091, -12.37906417,  28.34154128])
axis = pivot - com
axis = axis / norm(axis)

# Init a rotation matrix.
R = zeros((3, 3), float64)

# Tilt the rotation axis by 85 degrees.
rot_axis = cross(axis, array([0, 0, 1]))
rot_axis = rot_axis / norm(rot_axis)
axis_angle_to_R(rot_axis, 85.0 * 2.0 * pi / 360.0, R)
print("Tilt axis: %s, norm = %s" % (repr(rot_axis), norm(rot_axis)))
print("CoM-pivot axis: %s, norm = %s" % (repr(axis), norm(axis)))
axis = dot(R, axis)
print("Rotation axis: %s, norm = %s" % (repr(axis), norm(axis)))

# Load N+1 copies of the original C-domain, rotating them about the rotation axis.
for i in range(N+1):
    # Load the PDB as a new model.
    structure.read_pdb('1J7P_1st_NH.pdb', dir='..', set_model_num=i)

    # The rotation angle.
    angle = (i - N/2) * INC / 360.0 * 2.0 * pi
    print("Rotation angle: %s" % angle)

    # The rotation matrix.
    axis_angle_to_R(axis, angle, R)
    print("Rotation matrix:\n%s\n" % R)

    # Rotate.
    structure.rotate(R=R, origin=pivot, model=i)

# Save the PDB file.
structure.write_pdb('distribution.pdb', compress_type=2, force=True)

# Create a PDB for the motional axis system.
end_pt = axis * norm(pivot - com) + pivot
structure.delete()
structure.add_atom(atom_name='C', res_name='AXE', res_num=1, pos=pivot, element='C')
structure.add_atom(atom_name='N', res_name='AXE', res_num=1, pos=end_pt, element='N')
structure.connect_atom(index1=0, index2=1)
structure.write_pdb('axis.pdb', compress_type=0, force=True)
----------------------------------------------------------------------------------------------------

relax> pipe.create(pipe_name='generate', pipe_type='N-state')
Tilt axis: array([ 0.77750136, -0.62888125,  0.        ]), norm = 1.0
CoM-pivot axis: array([ 0.51520307,  0.63695822, -0.57345447]), norm = 1.0
Rotation axis: array([ 0.40416535,  0.49967956,  0.76614014]), norm = 1.0

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=0, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model None (from the original molecule number 1 of model None)
Rotation angle: -0.523598775598
Rotation matrix:
[[ 0.8879101   0.41012666 -0.20835491]
 [-0.35601348  0.89947614  0.25337144]
 [ 0.29132465 -0.15079391  0.94466457]]


relax> structure.rotate(R=array([[ 0.8879101 ,  0.41012666, -0.20835491],
       [-0.35601348,  0.89947614,  0.25337144],
       [ 0.29132465, -0.15079391,  0.94466457]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=0)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=1, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 1 (from the original molecule number 1 of model None)
Rotation angle: -0.488692190558
Rotation matrix:
[[ 0.90206806  0.38332011 -0.19834038]
 [-0.3360419   0.9121732   0.23455467]
 [ 0.2708303  -0.1449336   0.95165393]]


relax> structure.rotate(R=array([[ 0.90206806,  0.38332011, -0.19834038],
       [-0.3360419 ,  0.9121732 ,  0.23455467],
       [ 0.2708303 , -0.1449336 ,  0.95165393]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=1)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=2, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 2 (from the original molecule number 1 of model None)
Rotation angle: -0.453785605519
Rotation matrix:
[[ 0.915326    0.35629259 -0.18770695]
 [-0.31541487  0.92406311  0.21591855]
 [ 0.25038325 -0.1384303   0.95819898]]


relax> structure.rotate(R=array([[ 0.915326  ,  0.35629259, -0.18770695],
       [-0.31541487,  0.92406311,  0.21591855],
       [ 0.25038325, -0.1384303 ,  0.95819898]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=2)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=3, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 3 (from the original molecule number 1 of model None)
Rotation angle: -0.418879020479
Rotation matrix:
[[ 0.92766777  0.32907704 -0.17646757]
 [-0.2941575   0.9351314   0.19748578]
 [ 0.2300084  -0.13129193  0.96429174]]


relax> structure.rotate(R=array([[ 0.92766777,  0.32907704, -0.17646757],
       [-0.2941575 ,  0.9351314 ,  0.19748578],
       [ 0.2300084 , -0.13129193,  0.96429174]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=3)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=4, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 4 (from the original molecule number 1 of model None)
Rotation angle: -0.383972435439
Rotation matrix:
[[ 0.93907834  0.3017066  -0.16463593]
 [-0.2722957   0.94536457  0.17927881]
 [ 0.20973058 -0.12352719  0.9699248 ]]


relax> structure.rotate(R=array([[ 0.93907834,  0.3017066 , -0.16463593],
       [-0.2722957 ,  0.94536457,  0.17927881],
       [ 0.20973058, -0.12352719,  0.9699248 ]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=4)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=5, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 5 (from the original molecule number 1 of model None)
Rotation angle: -0.349065850399
Rotation matrix:
[[ 0.94954381  0.27421463 -0.15222646]
 [-0.24985609  0.95475015  0.16131984]
 [ 0.18957449 -0.11514554  0.97509129]]


relax> structure.rotate(R=array([[ 0.94954381,  0.27421463, -0.15222646],
       [-0.24985609,  0.95475015,  0.16131984],
       [ 0.18957449, -0.11514554,  0.97509129]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=5)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=6, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 6 (from the original molecule number 1 of model None)
Rotation angle: -0.314159265359
Rotation matrix:
[[ 0.95905142  0.24663461 -0.13925426]
 [-0.22686603  0.96327671  0.14363073]
 [ 0.16956469 -0.10615719  0.97978491]]


relax> structure.rotate(R=array([[ 0.95905142,  0.24663461, -0.13925426],
       [-0.22686603,  0.96327671,  0.14363073],
       [ 0.16956469, -0.10615719,  0.97978491]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=6)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=7, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 7 (from the original molecule number 1 of model None)
Rotation angle: -0.279252680319
Rotation matrix:
[[ 0.96758958  0.21900017 -0.12573514]
 [-0.20335352  0.97093386  0.12623304]
 [ 0.14972556 -0.09657309  0.98399995]]


relax> structure.rotate(R=array([[ 0.96758958,  0.21900017, -0.12573514],
       [-0.20335352,  0.97093386,  0.12623304],
       [ 0.14972556, -0.09657309,  0.98399995]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=7)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=8, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 8 (from the original molecule number 1 of model None)
Rotation angle: -0.244346095279
Rotation matrix:
[[ 0.97514791  0.19134495 -0.11168558]
 [-0.1793472   0.97771228  0.10914797]
 [ 0.13008127 -0.08640492  0.98773127]]


relax> structure.rotate(R=array([[ 0.97514791,  0.19134495, -0.11168558],
       [-0.1793472 ,  0.97771228,  0.10914797],
       [ 0.13008127, -0.08640492,  0.98773127]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=8)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=9, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 9 (from the original molecule number 1 of model None)
Rotation angle: -0.209439510239
Rotation matrix:
[[ 0.98171718  0.16370265 -0.09712269]
 [-0.15487633  0.9836037   0.09239634]
 [ 0.11065576 -0.07566507  0.99097432]]


relax> structure.rotate(R=array([[ 0.98171718,  0.16370265, -0.09712269],
       [-0.15487633,  0.9836037 ,  0.09239634],
       [ 0.11065576, -0.07566507,  0.99097432]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=9)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=10, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 10 (from the original molecule number 1 of model None)
Rotation angle: -0.174532925199
Rotation matrix:
[[ 0.9872894   0.13610696 -0.08206421]
 [-0.12997072  0.98860095  0.07599854]
 [ 0.09147268 -0.06436661  0.99372516]]


relax> structure.rotate(R=array([[ 0.9872894 ,  0.13610696, -0.08206421],
       [-0.12997072,  0.98860095,  0.07599854],
       [ 0.09147268, -0.06436661,  0.99372516]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=10)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=11, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 11 (from the original molecule number 1 of model None)
Rotation angle: -0.13962634016
Rotation matrix:
[[ 0.99185778  0.10859149 -0.06652849]
 [-0.1046607   0.99269793  0.05997457]
 [ 0.07255542 -0.05252332  0.99598043]]


relax> structure.rotate(R=array([[ 0.99185778,  0.10859149, -0.06652849],
       [-0.1046607 ,  0.99269793,  0.05997457],
       [ 0.07255542, -0.05252332,  0.99598043]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=11)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=12, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 12 (from the original molecule number 1 of model None)
Rotation angle: -0.10471975512
Rotation matrix:
[[ 0.99541674  0.08118977 -0.05053446]
 [-0.07897713  0.99588967  0.04434394]
 [ 0.05392702 -0.04014963  0.99773738]]


relax> structure.rotate(R=array([[ 0.99541674,  0.08118977, -0.05053446],
       [-0.07897713,  0.99588967,  0.04434394],
       [ 0.05392702, -0.04014963,  0.99773738]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=12)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=13, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 13 (from the original molecule number 1 of model None)
Rotation angle: -0.0698131700798
Rotation matrix:
[[ 0.99796196  0.05393518 -0.0341016 ]
 [-0.05295129  0.99817226  0.02912569]
 [ 0.03561017 -0.02726061  0.99899388]]


relax> structure.rotate(R=array([[ 0.99796196,  0.05393518, -0.0341016 ],
       [-0.05295129,  0.99817226,  0.02912569],
       [ 0.03561017, -0.02726061,  0.99899388]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=13)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=14, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 14 (from the original molecule number 1 of model None)
Rotation angle: -0.0349065850399
Rotation matrix:
[[ 0.99949034  0.02686093 -0.01724994]
 [-0.02661488  0.99954293  0.01433837]
 [ 0.01762719 -0.01387196  0.99974839]]


relax> structure.rotate(R=array([[ 0.99949034,  0.02686093, -0.01724994],
       [-0.02661488,  0.99954293,  0.01433837],
       [ 0.01762719, -0.01387196,  0.99974839]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=14)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=15, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 15 (from the original molecule number 1 of model None)
Rotation angle: 0.0
Rotation matrix:
[[ 1.  0.  0.]
 [ 0.  1.  0.]
 [ 0.  0.  1.]]


relax> structure.rotate(R=array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=15)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=16, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 16 (from the original molecule number 1 of model None)
Rotation angle: 0.0349065850399
Rotation matrix:
[[ 0.99949034 -0.02661488  0.01762719]
 [ 0.02686093  0.99954293 -0.01387196]
 [-0.01724994  0.01433837  0.99974839]]


relax> structure.rotate(R=array([[ 0.99949034, -0.02661488,  0.01762719],
       [ 0.02686093,  0.99954293, -0.01387196],
       [-0.01724994,  0.01433837,  0.99974839]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=16)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=17, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 17 (from the original molecule number 1 of model None)
Rotation angle: 0.0698131700798
Rotation matrix:
[[ 0.99796196 -0.05295129  0.03561017]
 [ 0.05393518  0.99817226 -0.02726061]
 [-0.0341016   0.02912569  0.99899388]]


relax> structure.rotate(R=array([[ 0.99796196, -0.05295129,  0.03561017],
       [ 0.05393518,  0.99817226, -0.02726061],
       [-0.0341016 ,  0.02912569,  0.99899388]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=17)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=18, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 18 (from the original molecule number 1 of model None)
Rotation angle: 0.10471975512
Rotation matrix:
[[ 0.99541674 -0.07897713  0.05392702]
 [ 0.08118977  0.99588967 -0.04014963]
 [-0.05053446  0.04434394  0.99773738]]


relax> structure.rotate(R=array([[ 0.99541674, -0.07897713,  0.05392702],
       [ 0.08118977,  0.99588967, -0.04014963],
       [-0.05053446,  0.04434394,  0.99773738]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=18)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=19, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 19 (from the original molecule number 1 of model None)
Rotation angle: 0.13962634016
Rotation matrix:
[[ 0.99185778 -0.1046607   0.07255542]
 [ 0.10859149  0.99269793 -0.05252332]
 [-0.06652849  0.05997457  0.99598043]]


relax> structure.rotate(R=array([[ 0.99185778, -0.1046607 ,  0.07255542],
       [ 0.10859149,  0.99269793, -0.05252332],
       [-0.06652849,  0.05997457,  0.99598043]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=19)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=20, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 20 (from the original molecule number 1 of model None)
Rotation angle: 0.174532925199
Rotation matrix:
[[ 0.9872894  -0.12997072  0.09147268]
 [ 0.13610696  0.98860095 -0.06436661]
 [-0.08206421  0.07599854  0.99372516]]


relax> structure.rotate(R=array([[ 0.9872894 , -0.12997072,  0.09147268],
       [ 0.13610696,  0.98860095, -0.06436661],
       [-0.08206421,  0.07599854,  0.99372516]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=20)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=21, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 21 (from the original molecule number 1 of model None)
Rotation angle: 0.209439510239
Rotation matrix:
[[ 0.98171718 -0.15487633  0.11065576]
 [ 0.16370265  0.9836037  -0.07566507]
 [-0.09712269  0.09239634  0.99097432]]


relax> structure.rotate(R=array([[ 0.98171718, -0.15487633,  0.11065576],
       [ 0.16370265,  0.9836037 , -0.07566507],
       [-0.09712269,  0.09239634,  0.99097432]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=21)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=22, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 22 (from the original molecule number 1 of model None)
Rotation angle: 0.244346095279
Rotation matrix:
[[ 0.97514791 -0.1793472   0.13008127]
 [ 0.19134495  0.97771228 -0.08640492]
 [-0.11168558  0.10914797  0.98773127]]


relax> structure.rotate(R=array([[ 0.97514791, -0.1793472 ,  0.13008127],
       [ 0.19134495,  0.97771228, -0.08640492],
       [-0.11168558,  0.10914797,  0.98773127]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=22)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=23, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 23 (from the original molecule number 1 of model None)
Rotation angle: 0.279252680319
Rotation matrix:
[[ 0.96758958 -0.20335352  0.14972556]
 [ 0.21900017  0.97093386 -0.09657309]
 [-0.12573514  0.12623304  0.98399995]]


relax> structure.rotate(R=array([[ 0.96758958, -0.20335352,  0.14972556],
       [ 0.21900017,  0.97093386, -0.09657309],
       [-0.12573514,  0.12623304,  0.98399995]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=23)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=24, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 24 (from the original molecule number 1 of model None)
Rotation angle: 0.314159265359
Rotation matrix:
[[ 0.95905142 -0.22686603  0.16956469]
 [ 0.24663461  0.96327671 -0.10615719]
 [-0.13925426  0.14363073  0.97978491]]


relax> structure.rotate(R=array([[ 0.95905142, -0.22686603,  0.16956469],
       [ 0.24663461,  0.96327671, -0.10615719],
       [-0.13925426,  0.14363073,  0.97978491]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=24)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=25, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 25 (from the original molecule number 1 of model None)
Rotation angle: 0.349065850399
Rotation matrix:
[[ 0.94954381 -0.24985609  0.18957449]
 [ 0.27421463  0.95475015 -0.11514554]
 [-0.15222646  0.16131984  0.97509129]]


relax> structure.rotate(R=array([[ 0.94954381, -0.24985609,  0.18957449],
       [ 0.27421463,  0.95475015, -0.11514554],
       [-0.15222646,  0.16131984,  0.97509129]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=25)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=26, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 26 (from the original molecule number 1 of model None)
Rotation angle: 0.383972435439
Rotation matrix:
[[ 0.93907834 -0.2722957   0.20973058]
 [ 0.3017066   0.94536457 -0.12352719]
 [-0.16463593  0.17927881  0.9699248 ]]


relax> structure.rotate(R=array([[ 0.93907834, -0.2722957 ,  0.20973058],
       [ 0.3017066 ,  0.94536457, -0.12352719],
       [-0.16463593,  0.17927881,  0.9699248 ]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=26)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=27, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 27 (from the original molecule number 1 of model None)
Rotation angle: 0.418879020479
Rotation matrix:
[[ 0.92766777 -0.2941575   0.2300084 ]
 [ 0.32907704  0.9351314  -0.13129193]
 [-0.17646757  0.19748578  0.96429174]]


relax> structure.rotate(R=array([[ 0.92766777, -0.2941575 ,  0.2300084 ],
       [ 0.32907704,  0.9351314 , -0.13129193],
       [-0.17646757,  0.19748578,  0.96429174]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=27)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=28, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 28 (from the original molecule number 1 of model None)
Rotation angle: 0.453785605519
Rotation matrix:
[[ 0.915326   -0.31541487  0.25038325]
 [ 0.35629259  0.92406311 -0.1384303 ]
 [-0.18770695  0.21591855  0.95819898]]


relax> structure.rotate(R=array([[ 0.915326  , -0.31541487,  0.25038325],
       [ 0.35629259,  0.92406311, -0.1384303 ],
       [-0.18770695,  0.21591855,  0.95819898]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=28)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=29, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 29 (from the original molecule number 1 of model None)
Rotation angle: 0.488692190558
Rotation matrix:
[[ 0.90206806 -0.3360419   0.2708303 ]
 [ 0.38332011  0.9121732  -0.1449336 ]
 [-0.19834038  0.23455467  0.95165393]]


relax> structure.rotate(R=array([[ 0.90206806, -0.3360419 ,  0.2708303 ],
       [ 0.38332011,  0.9121732 , -0.1449336 ],
       [-0.19834038,  0.23455467,  0.95165393]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=29)

relax> structure.read_pdb(file='1J7P_1st_NH.pdb', dir='..', read_mol=None, set_mol_name=None, read_model=None, set_model_num=30, parser='internal')

Internal relax PDB parser.
Opening the file '../1J7P_1st_NH.pdb' for reading.
Adding molecule '1J7P_1st_NH_mol1' to model 30 (from the original molecule number 1 of model None)
Rotation angle: 0.523598775598
Rotation matrix:
[[ 0.8879101  -0.35601348  0.29132465]
 [ 0.41012666  0.89947614 -0.15079391]
 [-0.20835491  0.25337144  0.94466457]]


relax> structure.rotate(R=array([[ 0.8879101 , -0.35601348,  0.29132465],
       [ 0.41012666,  0.89947614, -0.15079391],
       [-0.20835491,  0.25337144,  0.94466457]]), origin=array([ 37.254 ,   0.5   ,  16.7465]), model=30)

relax> structure.write_pdb(file='distribution.pdb', dir=None, model_num=None, compress_type=2, force=True)
Opening the file 'distribution.pdb.gz' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL

MODEL 1
ATOM, HETATM, TER
ENDMDL

MODEL 2
ATOM, HETATM, TER
ENDMDL

MODEL 3
ATOM, HETATM, TER
ENDMDL

MODEL 4
ATOM, HETATM, TER
ENDMDL

MODEL 5
ATOM, HETATM, TER
ENDMDL

MODEL 6
ATOM, HETATM, TER
ENDMDL

MODEL 7
ATOM, HETATM, TER
ENDMDL

MODEL 8
ATOM, HETATM, TER
ENDMDL

MODEL 9
ATOM, HETATM, TER
ENDMDL

MODEL 10
ATOM, HETATM, TER
ENDMDL

MODEL 11
ATOM, HETATM, TER
ENDMDL

MODEL 12
ATOM, HETATM, TER
ENDMDL

MODEL 13
ATOM, HETATM, TER
ENDMDL

MODEL 14
ATOM, HETATM, TER
ENDMDL

MODEL 15
ATOM, HETATM, TER
ENDMDL

MODEL 16
ATOM, HETATM, TER
ENDMDL

MODEL 17
ATOM, HETATM, TER
ENDMDL

MODEL 18
ATOM, HETATM, TER
ENDMDL

MODEL 19
ATOM, HETATM, TER
ENDMDL

MODEL 20
ATOM, HETATM, TER
ENDMDL

MODEL 21
ATOM, HETATM, TER
ENDMDL

MODEL 22
ATOM, HETATM, TER
ENDMDL

MODEL 23
ATOM, HETATM, TER
ENDMDL

MODEL 24
ATOM, HETATM, TER
ENDMDL

MODEL 25
ATOM, HETATM, TER
ENDMDL

MODEL 26
ATOM, HETATM, TER
ENDMDL

MODEL 27
ATOM, HETATM, TER
ENDMDL

MODEL 28
ATOM, HETATM, TER
ENDMDL

MODEL 29
ATOM, HETATM, TER
ENDMDL

MODEL 30
ATOM, HETATM, TER
ENDMDL
CONECT

MASTER
END

relax> structure.delete()
Deleting the following structural data:

Models.

Index   Model number
0       None    
1       1       
2       2       
3       3       
4       4       
5       5       
6       6       
7       7       
8       8       
9       9       
10      10      
11      11      
12      12      
13      13      
14      14      
15      15      
16      16      
17      17      
18      18      
19      19      
20      20      
21      21      
22      22      
23      23      
24      24      
25      25      
26      26      
27      27      
28      28      
29      29      
30      30      


relax> structure.add_atom(atom_name='C', res_name='AXE', res_num=1, pos=array([ 37.254 ,   0.5   ,  16.7465]), element='C', atom_num=None, chain_id=None, segment_id=None, pdb_record=None)
Adding molecule 'None' to model None (from the original molecule number None of model None)

relax> structure.add_atom(atom_name='N', res_name='AXE', res_num=1, pos=array([ 45.42607668,  10.60333938,  32.23757568]), element='N', atom_num=None, chain_id=None, segment_id=None, pdb_record=None)

relax> structure.connect_atom(index1=0, index2=1)

relax> structure.write_pdb(file='axis.pdb', dir=None, model_num=None, compress_type=0, force=True)
Opening the file 'axis.pdb' for writing.

Creating the PDB records

REMARK
HET
HETNAM
FORMUL
ATOM, HETATM, TER
CONECT

MASTER
END

